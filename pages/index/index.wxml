<!--index.wxml-->
<wxs module="funs" src="../../utils/funs.wxs"></wxs>
<view class="container" bindtap="con_tap">
  <view class='search_container'>
    <view class='search_input_wrap'>
      <image src='../../images/search.png' class='search_icon' />
      <input type="text" class='search_input' confirm-type="search" bindconfirm="search" />
    </view>
    <view class='search_input_funs'>
      <text class="iconfont icon-m-order" catchtap="showOrder"></text>
      <text class="iconfont icon-m-grid"></text>
      <text class="iconfont icon-m-add" catchtap="showAdd"></text>
    </view>
    <view class='search_order' style="display:{{showOrder==true?'flex':'none'}}">
      <view id="FileName" class="{{orderField=='FileName'?'current':''}}" catchtap="changOrder">文件名称 {{orderField=='FileName'?'✔':''}}</view>
      <view id="Length" class="{{orderField=='Length'?'current':''}}" catchtap="changOrder">文件大小 {{orderField=='Length'?'✔':''}}</view>
      <view id="CreateTime" class="{{orderField=='CreateTime'?'current':''}}" catchtap="changOrder">创建时间 {{orderField=='CreateTime'?'✔':''}}</view>
    </view>
    <view class='search_add' style="display:{{showAdd==true?'flex':'none'}}">
      <view>
        <text class="iconfont icon-m-image"></text>
        <text class='funs_text'>添加图片</text>
      </view>
      <view>
        <text class="iconfont icon-m-video"></text>
        <text class='funs_text'>添加视频</text>
      </view>
      <view>
        <text class="iconfont icon-m-attachment"></text>
        <text class='funs_text'>添加附件</text>
      </view>
    </view>
  </view>
  <view class="data_container">
    <view class="data_line" wx:for="{{result}}" wx:key="unique" id="{{item.FileId.$oid}}" >
      <view class='data_line_image_wrap' style="background-image: url({{getFileIcon+'/'+item.FileId.$oid+funs.getFileExtension(item.FileName)+'?auth_token='+token}})">
      </view>
      <view class="data_meta">
        <view class="data_meta_title">{{funs.getFileName(item.FileName,10)}}</view>
        <view class="data_meta_subtitle">
          {{funs.convertFileSize(item.Length)}} | {{funs.parseBsonTime(item.CreateTime)}}
        </view>
      </view>
      <view class="data_option" id="{{item.FileId.$oid}}">
        <text class="iconfont icon-m-selected"></text>
      </view>
    </view>
    <view class='loading' wx:if="{{showLoading==true&&end==false}}">
      <image src='../../images/loading.gif' />
    </view>
    <view class='data_end' wx:if="{{showLoading==true&&end==true}}">--- end ---</view>
  </view>
</view>